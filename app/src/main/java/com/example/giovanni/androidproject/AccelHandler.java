package com.example.giovanni.androidproject;
import android.app.Activity;
import android.content.Context;
import android.hardware.Sensor;
import android.hardware.SensorManager;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.os.Handler;
import android.util.Log;

import java.util.ArrayList;

public class AccelHandler implements SensorEventListener {

    private float xAxis;
    private float yAxis;
    private float zAxis;
    ArrayList<String> logList = new ArrayList<String>();
    SensorManager manager;
    Sensor accelerometer;
    Activity context;

    private Handler handler = new Handler();

    public AccelHandler(Activity foo) {
        this.context = foo;
        manager = (SensorManager) this.context.getSystemService(Context.SENSOR_SERVICE);
        accelerometer = manager.getSensorList(Sensor.TYPE_ACCELEROMETER).get(0);
        manager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_GAME);
    }


    public float getX(){
        return this.xAxis;
    }

    public float getY(){
        return this.yAxis;
    }

    public float getZ(){
        return this.zAxis;
    }

    public void onAccuracyChanged(Sensor sensor, int accuracy) {
        // TODO Auto-generated method stub

    }

    public void onSensorChanged(SensorEvent event) {

        xAxis = event.values[0];
        yAxis = event.values[1];
        zAxis = event.values[2];

        handler.sendEmptyMessageDelayed(1, 200);
        refresh();
    }

    public String returnLogList()
    {
        String temp="";
        for (String object: logList) {
            temp+=object + System.getProperty("line.separator");
        }
        return temp;
    }

    public void refresh(){
        Log.i("accell" +
                "Log","X:"+xAxis+" - Y:"+yAxis+" - Z:"+zAxis );
        String logstr = "Accellerometer: "+" X:"+ xAxis + " - Y:" + yAxis + " - Z:" +zAxis;
        logList.add(logstr);
    }
}